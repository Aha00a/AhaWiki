@(supported:String = "")(implicit wikiContext: models.WikiContext, request: play.api.mvc.Request[Any])
@import helper._
@import com.aha00a.commons.implicits.Implicits._
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.devbridge-autocomplete/1.2.24/jquery.autocomplete.min.js"></script>
<script type="text/javascript">
    @for(hotkeys <- Seq(Map(
        'f' -> "go('/')",
        'a' -> "go('/w/AhaWiki')",
        's' -> "go('/w/AhaWikiSyntax')",
        'c' -> "go('/w/RecentChanges')",
        't' -> "go('/w/TitleIndex')",
        'l' -> "go('/w/PageList')",
        'm' -> "go('/w/PageMap')",
        'r' -> "go('/r')",
        'e' -> "go('?action=edit')",
        'h' -> "go('?action=history')",
        'g' -> "showSearch()",
        '/' -> "showSearch()",
        'w' -> "showWrite()"
    ))) {

        function showSearch() {
            $.get(
                    '@routes.Api.pageNames()',
                    {},
                    function (data, textStatus, jqXHR) {
                        $("body").append($('<div class="searchBg"></div><div class="search"><form action="/search"><input type="text" name="q"/></form></div>'));
                        $('.searchBg').click(function () {
                            hideSearch();
                        });
                        $('[name=q]').keydown(function (e) {
                            if (e.keyCode == 27) {
                                hideSearch();
                            }
                        }).autocomplete({
                            lookup: data,
                            onSelect: function (suggestion) {
                                hideSearch();
                                go('/w/' + suggestion.value);
                                return false;
                            }
                        }).focus();
                    }
            ).error(function (jqXHR, textStatue, httpStatus) {
                alert(jqXHR.responseJSON.message);
            });
            return false;
        }
        function hideSearch() {
            $('.search, .searchBg').remove();
        }

        function showWrite() {
            $.get(
                    '@routes.Api.pageNames()',
                    {},
                    function (data, textStatus, jqXHR) {
                        $("body").append($('<div class="searchBg"></div><div class="search"><form action="@routes.Diary.write()" method="post">@CSRF.formField <input type="text" name="q"/></div>'));
                        $('.searchBg').click(function () {
                            hideSearch();
                        });
                        $('[name=q]').keydown(function (e) {
                            if (e.keyCode == 27) {
                                hideSearch();
                            }
                        }).focus();
                    }
            ).error(function (jqXHR, textStatue, httpStatus) {
                alert(jqXHR.responseJSON.message);
            });
            return false;
        }

        function go(s) {
            location.href = s;
            return true;
        }

        $(function(){

            @for(key <- supported.getOrElse(hotkeys.keys.mkString)) {
                $(document).bind('keydown', '@key', function () { return @Html(hotkeys(key)) });
            }
        });
    }
</script>
